{"version":3,"file":"js/853.31d06621.js","mappings":"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","sources":["webpack://web/./src/views/main/order.vue","webpack://web/./src/views/main/order.vue?1e61"],"sourcesContent":["<template>\r\n  <div class=\"order-train\">\r\n    <span class=\"order-train-main\">{{dailyTrainTicket.date}}</span>&nbsp;\r\n    <span class=\"order-train-main\">{{dailyTrainTicket.trainCode}}</span>次&nbsp;\r\n    <span class=\"order-train-main\">{{dailyTrainTicket.start}}</span>站\r\n    <span class=\"order-train-main\">({{dailyTrainTicket.startTime}})</span>&nbsp;\r\n    <span class=\"order-train-main\">——</span>&nbsp;\r\n    <span class=\"order-train-main\">{{dailyTrainTicket.end}}</span>站\r\n    <span class=\"order-train-main\">({{dailyTrainTicket.endTime}})</span>&nbsp;\r\n\r\n    <div class=\"order-train-ticket\">\r\n      <span v-for=\"item in seatTypes\" :key=\"item.type\">\r\n        <span>{{item.desc}}</span>：\r\n        <span class=\"order-train-ticket-main\">{{item.price}}￥</span>&nbsp;\r\n        <span class=\"order-train-ticket-main\">{{item.count}}</span>&nbsp;张票&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n      </span>\r\n    </div>\r\n  </div>\r\n  <a-divider></a-divider>\r\n  <b>勾选要购票的乘客：</b>&nbsp;\r\n  <a-checkbox-group v-model:value=\"passengerChecks\" :options=\"passengerOptions\" />\r\n\r\n  <div class=\"order-tickets\">\r\n    <a-row class=\"order-tickets-header\" v-if=\"tickets.length > 0\">\r\n      <a-col :span=\"2\">乘客</a-col>\r\n      <a-col :span=\"6\">身份证</a-col>\r\n      <a-col :span=\"4\">票种</a-col>\r\n      <a-col :span=\"4\">座位类型</a-col>\r\n    </a-row>\r\n    <a-row class=\"order-tickets-row\" v-for=\"ticket in tickets\" :key=\"ticket.passengerId\">\r\n      <a-col :span=\"2\">{{ticket.passengerName}}</a-col>\r\n      <a-col :span=\"6\">{{ticket.passengerIdCard}}</a-col>\r\n      <a-col :span=\"4\">\r\n        <a-select v-model:value=\"ticket.passengerType\" style=\"width: 100%\">\r\n          <a-select-option v-for=\"item in PASSENGER_TYPE_ARRAY\" :key=\"item.code\" :value=\"item.code\">\r\n            {{item.desc}}\r\n          </a-select-option>\r\n        </a-select>\r\n      </a-col>\r\n      <a-col :span=\"4\">\r\n        <a-select v-model:value=\"ticket.seatTypeCode\" style=\"width: 100%\">\r\n          <a-select-option v-for=\"item in seatTypes\" :key=\"item.code\" :value=\"item.code\">\r\n            {{item.desc}}\r\n          </a-select-option>\r\n        </a-select>\r\n      </a-col>\r\n    </a-row>\r\n  </div>\r\n  <div v-if=\"tickets.length > 0\">\r\n    <a-button type=\"primary\" size=\"large\" @click=\"finishCheckPassenger\">提交订单</a-button>\r\n  </div>\r\n\r\n  <a-modal v-model:visible=\"visible\" title=\"请核对以下信息\"\r\n           style=\"top: 50px; width: 800px\"\r\n           ok-text=\"确认\" cancel-text=\"取消\"\r\n           @ok=\"showFirstImageCodeModal\">\r\n    <div class=\"order-tickets\">\r\n      <a-row class=\"order-tickets-header\" v-if=\"tickets.length > 0\">\r\n        <a-col :span=\"3\">乘客</a-col>\r\n        <a-col :span=\"15\">身份证</a-col>\r\n        <a-col :span=\"3\">票种</a-col>\r\n        <a-col :span=\"3\">座位类型</a-col>\r\n      </a-row>\r\n      <a-row class=\"order-tickets-row\" v-for=\"ticket in tickets\" :key=\"ticket.passengerId\">\r\n        <a-col :span=\"3\">{{ticket.passengerName}}</a-col>\r\n        <a-col :span=\"15\">{{ticket.passengerIdCard}}</a-col>\r\n        <a-col :span=\"3\">\r\n          <span v-for=\"item in PASSENGER_TYPE_ARRAY\" :key=\"item.code\">\r\n            <span v-if=\"item.code === ticket.passengerType\">\r\n              {{item.desc}}\r\n            </span>\r\n          </span>\r\n        </a-col>\r\n        <a-col :span=\"3\">\r\n          <span v-for=\"item in seatTypes\" :key=\"item.code\">\r\n            <span v-if=\"item.code === ticket.seatTypeCode\">\r\n              {{item.desc}}\r\n            </span>\r\n          </span>\r\n        </a-col>\r\n      </a-row>\r\n      <br/>\r\n      <div v-if=\"chooseSeatType === 0\" style=\"color: red;\">\r\n        您购买的车票不支持选座\r\n        <div>12306规则：只有全部是一等座或全部是二等座才支持选座</div>\r\n        <div>12306规则：余票小于一定数量时，不允许选座（本项目以20为例）</div>\r\n      </div>\r\n      <div v-else style=\"text-align: center\">\r\n        <a-switch class=\"choose-seat-item\" v-for=\"item in SEAT_COL_ARRAY\" :key=\"item.code\"\r\n                  v-model:checked=\"chooseSeatObj[item.code + '1']\" :checked-children=\"item.desc\" :un-checked-children=\"item.desc\" />\r\n        <div v-if=\"tickets.length > 1\">\r\n          <a-switch class=\"choose-seat-item\" v-for=\"item in SEAT_COL_ARRAY\" :key=\"item.code\"\r\n                    v-model:checked=\"chooseSeatObj[item.code + '2']\" :checked-children=\"item.desc\" :un-checked-children=\"item.desc\" />\r\n        </div>\r\n        <div style=\"color: #999999\">提示：您可以选择{{tickets.length}}个座位</div>\r\n      </div>\r\n      <!--<br/>-->\r\n      <!--最终购票：{{tickets}}-->\r\n      <!--最终选座：{{chooseSeatObj}}-->\r\n    </div>\r\n  </a-modal>\r\n\r\n  <!-- 第二层验证码 后端 -->\r\n  <a-modal v-model:visible=\"imageCodeModalVisible\" :title=\"null\" :footer=\"null\" :closable=\"false\"\r\n           style=\"top: 50px; width: 400px\">\r\n    <p style=\"text-align: center; font-weight: bold; font-size: 18px\">\r\n      使用服务端验证码削弱瞬时高峰<br/>\r\n      防止机器人刷票\r\n    </p>\r\n    <p>\r\n      <a-input v-model:value=\"imageCode\" placeholder=\"图片验证码\">\r\n        <template #suffix>\r\n          <img v-show=\"!!imageCodeSrc\" :src=\"imageCodeSrc\" alt=\"验证码\" v-on:click=\"loadImageCode()\"/>\r\n        </template>\r\n      </a-input>\r\n    </p>\r\n    <a-button type=\"danger\" block @click=\"handleOk\">输入验证码后开始购票</a-button>\r\n  </a-modal>\r\n\r\n  <!-- 第一层验证码 纯前端 -->\r\n  <a-modal v-model:visible=\"firstImageCodeModalVisible\" :title=\"null\" :footer=\"null\" :closable=\"false\"\r\n           style=\"top: 50px; width: 400px\">\r\n    <p style=\"text-align: center; font-weight: bold; font-size: 18px\">\r\n      使用纯前端验证码削弱瞬时高峰<br/>\r\n      减小后端验证码接口的压力\r\n    </p>\r\n    <p>\r\n      <a-input v-model:value=\"firstImageCodeTarget\" placeholder=\"验证码\">\r\n        <template #suffix>\r\n          {{firstImageCodeSourceA}} + {{firstImageCodeSourceB}}\r\n        </template>\r\n      </a-input>\r\n    </p>\r\n    <a-button type=\"danger\" block @click=\"validFirstImageCode\">提交验证码</a-button>\r\n  </a-modal>\r\n\r\n  <a-modal v-model:visible=\"lineModalVisible\" title=\"排队购票\" :footer=\"null\" :maskClosable=\"false\" :closable=\"false\"\r\n           style=\"top: 50px; width: 400px\">\r\n    <div class=\"book-line\">\r\n      <div v-show=\"confirmOrderLineCount < 0\">\r\n        <loading-outlined /> 系统正在处理中...\r\n      </div>\r\n      <div v-show=\"confirmOrderLineCount >= 0\">\r\n        <loading-outlined /> 您前面还有{{confirmOrderLineCount}}位用户在购票，排队中，请稍候\r\n      </div>\r\n    </div>\r\n  </a-modal>\r\n</template>\r\n\r\n<script>\r\n\r\nimport {defineComponent, ref, onMounted, watch, computed} from 'vue';\r\nimport axios from \"axios\";\r\nimport {notification} from \"ant-design-vue\";\r\n\r\nexport default defineComponent({\r\n  name: \"order-view\",\r\n  setup() {\r\n    const passengers = ref([]);\r\n    const passengerOptions = ref([]);\r\n    const passengerChecks = ref([]);\r\n    const dailyTrainTicket = SessionStorage.get(SESSION_ORDER) || {};\r\n    console.log(\"下单的车次信息\", dailyTrainTicket);\r\n\r\n    const SEAT_TYPE = window.SEAT_TYPE;\r\n    console.log(SEAT_TYPE)\r\n    // 本车次提供的座位类型seatTypes，含票价，余票等信息，例：\r\n    // {\r\n    //   type: \"YDZ\",\r\n    //   code: \"1\",\r\n    //   desc: \"一等座\",\r\n    //   count: \"100\",\r\n    //   price: \"50\",\r\n    // }\r\n    // 关于SEAT_TYPE[KEY]：当知道某个具体的属性xxx时，可以用obj.xxx，当属性名是个变量时，可以使用obj[xxx]\r\n    const seatTypes = [];\r\n    for (let KEY in SEAT_TYPE) {\r\n      let key = KEY.toLowerCase();\r\n      if (dailyTrainTicket[key] >= 0) {\r\n        seatTypes.push({\r\n          type: KEY,\r\n          code: SEAT_TYPE[KEY][\"code\"],\r\n          desc: SEAT_TYPE[KEY][\"desc\"],\r\n          count: dailyTrainTicket[key],\r\n          price: dailyTrainTicket[key + 'Price'],\r\n        })\r\n      }\r\n    }\r\n    console.log(\"本车次提供的座位：\", seatTypes)\r\n    // 购票列表，用于界面展示，并传递到后端接口，用来描述：哪个乘客购买什么座位的票\r\n    // {\r\n    //   passengerId: 123,\r\n    //   passengerType: \"1\",\r\n    //   passengerName: \"张三\",\r\n    //   passengerIdCard: \"12323132132\",\r\n    //   seatTypeCode: \"1\",\r\n    //   seat: \"C1\"\r\n    // }\r\n    const tickets = ref([]);\r\n    const PASSENGER_TYPE_ARRAY = window.PASSENGER_TYPE_ARRAY;\r\n    const visible = ref(false);\r\n    const lineModalVisible = ref(false);\r\n    const confirmOrderId = ref();\r\n    const confirmOrderLineCount = ref(-1);\r\n\r\n    // 勾选或去掉某个乘客时，在购票列表中加上或去掉一张表\r\n    watch(() => passengerChecks.value, (newVal, oldVal)=>{\r\n      console.log(\"勾选乘客发生变化\", newVal, oldVal)\r\n      // 每次有变化时，把购票列表清空，重新构造列表\r\n      tickets.value = [];\r\n      passengerChecks.value.forEach((item) => tickets.value.push({\r\n        passengerId: item.id,\r\n        passengerType: item.type,\r\n        seatTypeCode: seatTypes[0].code,\r\n        passengerName: item.name,\r\n        passengerIdCard: item.idCard\r\n      }))\r\n    }, {immediate: true});\r\n\r\n    // 0：不支持选座；1：选一等座；2：选二等座\r\n    const chooseSeatType = ref(0);\r\n    // 根据选择的座位类型，计算出对应的列，比如要选的是一等座，就筛选出ACDF，要选的是二等座，就筛选出ABCDF\r\n    const SEAT_COL_ARRAY = computed(() => {\r\n      return window.SEAT_COL_ARRAY.filter(item => item.type === chooseSeatType.value);\r\n    });\r\n    // 选择的座位\r\n    // {\r\n    //   A1: false, C1: true，D1: false, F1: false，\r\n    //   A2: false, C2: false，D2: true, F2: false\r\n    // }\r\n    const chooseSeatObj = ref({});\r\n    watch(() => SEAT_COL_ARRAY.value, () => {\r\n      chooseSeatObj.value = {};\r\n      for (let i = 1; i <= 2; i++) {\r\n        SEAT_COL_ARRAY.value.forEach((item) => {\r\n          chooseSeatObj.value[item.code + i] = false;\r\n        })\r\n      }\r\n      console.log(\"初始化两排座位，都是未选中：\", chooseSeatObj.value);\r\n    }, {immediate: true});\r\n\r\n    const handleQueryPassenger = () => {\r\n      axios.get(\"/member/passenger/query-mine\").then((response) => {\r\n        let data = response.data;\r\n        if (data.success) {\r\n          passengers.value = data.content;\r\n          passengers.value.forEach((item) => passengerOptions.value.push({\r\n            label: item.name,\r\n            value: item\r\n          }))\r\n        } else {\r\n          notification.error({description: data.message});\r\n        }\r\n      });\r\n    };\r\n\r\n    const finishCheckPassenger = () => {\r\n      console.log(\"购票列表：\", tickets.value);\r\n\r\n      if (tickets.value.length > 5) {\r\n        notification.error({description: '最多只能购买5张车票'});\r\n        return;\r\n      }\r\n\r\n      // 校验余票是否充足，购票列表中的每个座位类型，都去车次座位余票信息中，看余票是否充足\r\n      // 前端校验不一定准，但前端校验可以减轻后端很多压力\r\n      // 注意：这段只是校验，必须copy出seatTypesTemp变量来扣减，用原始的seatTypes去扣减，会影响真实的库存\r\n      let seatTypesTemp = Tool.copy(seatTypes);\r\n      for (let i = 0; i < tickets.value.length; i++) {\r\n        let ticket = tickets.value[i];\r\n        for (let j = 0; j < seatTypesTemp.length; j++) {\r\n          let seatType = seatTypesTemp[j];\r\n          // 同类型座位余票-1，这里扣减的是临时copy出来的库存，不是真正的库存，只是为了校验\r\n          if (ticket.seatTypeCode === seatType.code) {\r\n            seatType.count--;\r\n            if (seatType.count < 0) {\r\n              notification.error({description: seatType.desc + '余票不足'});\r\n              return;\r\n            }\r\n          }\r\n        }\r\n      }\r\n      console.log(\"前端余票校验通过\");\r\n\r\n      // 判断是否支持选座，只有纯一等座和纯二等座支持选座\r\n      // 先筛选出购票列表中的所有座位类型，比如四张表：[1, 1, 2, 2]\r\n      let ticketSeatTypeCodes = [];\r\n      for (let i = 0; i < tickets.value.length; i++) {\r\n        let ticket = tickets.value[i];\r\n        ticketSeatTypeCodes.push(ticket.seatTypeCode);\r\n      }\r\n      // 为购票列表中的所有座位类型去重：[1, 2]\r\n      const ticketSeatTypeCodesSet = Array.from(new Set(ticketSeatTypeCodes));\r\n      console.log(\"选好的座位类型：\", ticketSeatTypeCodesSet);\r\n      if (ticketSeatTypeCodesSet.length !== 1) {\r\n        console.log(\"选了多种座位，不支持选座\");\r\n        chooseSeatType.value = 0;\r\n      } else {\r\n        // ticketSeatTypeCodesSet.length === 1，即只选择了一种座位（不是一个座位，是一种座位）\r\n        if (ticketSeatTypeCodesSet[0] === SEAT_TYPE.YDZ.code) {\r\n          console.log(\"一等座选座\");\r\n          chooseSeatType.value = SEAT_TYPE.YDZ.code;\r\n        } else if (ticketSeatTypeCodesSet[0] === SEAT_TYPE.EDZ.code) {\r\n          console.log(\"二等座选座\");\r\n          chooseSeatType.value = SEAT_TYPE.EDZ.code;\r\n        } else {\r\n          console.log(\"不是一等座或二等座，不支持选座\");\r\n          chooseSeatType.value = 0;\r\n        }\r\n\r\n        // 余票小于20张时，不允许选座，否则选座成功率不高，影响出票\r\n        if (chooseSeatType.value !== 0) {\r\n          for (let i = 0; i < seatTypes.length; i++) {\r\n            let seatType = seatTypes[i];\r\n            // 找到同类型座位\r\n            if (ticketSeatTypeCodesSet[0] === seatType.code) {\r\n              // 判断余票，小于20张就不支持选座\r\n              if (seatType.count < 20) {\r\n                console.log(\"余票小于20张就不支持选座\")\r\n                chooseSeatType.value = 0;\r\n                break;\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n\r\n      // 弹出确认界面\r\n      visible.value = true;\r\n\r\n    };\r\n\r\n    const handleOk = () => {\r\n      if (Tool.isEmpty(imageCode.value)) {\r\n        notification.error({description: '验证码不能为空'});\r\n        return;\r\n      }\r\n\r\n      console.log(\"选好的座位：\", chooseSeatObj.value);\r\n\r\n      // 设置每张票的座位\r\n      // 先清空购票列表的座位，有可能之前选了并设置座位了，但选座数不对被拦截了，又重新选一遍\r\n      for (let i = 0; i < tickets.value.length; i++) {\r\n        tickets.value[i].seat = null;\r\n      }\r\n      let i = -1;\r\n      // 要么不选座位，要么所选座位应该等于购票数，即i === (tickets.value.length - 1)\r\n      for (let key in chooseSeatObj.value) {\r\n        if (chooseSeatObj.value[key]) {\r\n          i++;\r\n          if (i > tickets.value.length - 1) {\r\n            notification.error({description: '所选座位数大于购票数'});\r\n            return;\r\n          }\r\n          tickets.value[i].seat = key;\r\n        }\r\n      }\r\n      if (i > -1 && i < (tickets.value.length - 1)) {\r\n        notification.error({description: '所选座位数小于购票数'});\r\n        return;\r\n      }\r\n\r\n      console.log(\"最终购票：\", tickets.value);\r\n\r\n      axios.post(\"/business/confirm-order/do\", {\r\n        dailyTrainTicketId: dailyTrainTicket.id,\r\n        date: dailyTrainTicket.date,\r\n        trainCode: dailyTrainTicket.trainCode,\r\n        start: dailyTrainTicket.start,\r\n        end: dailyTrainTicket.end,\r\n        tickets: tickets.value,\r\n        imageCodeToken: imageCodeToken.value,\r\n        imageCode: imageCode.value,\r\n      }).then((response) => {\r\n        let data = response.data;\r\n        if (data.success) {\r\n          // notification.success({description: \"下单成功！\"});\r\n          visible.value = false;\r\n          imageCodeModalVisible.value = false;\r\n          lineModalVisible.value = true;\r\n          confirmOrderId.value = data.content;\r\n          queryLineCount();\r\n        } else {\r\n          notification.error({description: data.message});\r\n        }\r\n      });\r\n    }\r\n\r\n    /* ------------------- 定时查询订单状态 --------------------- */\r\n    // 确认订单后定时查询\r\n    let queryLineCountInterval;\r\n\r\n    // 定时查询订单结果/排队数量\r\n    const queryLineCount = () => {\r\n      confirmOrderLineCount.value = -1;\r\n      queryLineCountInterval = setInterval(function () {\r\n        axios.get(\"/business/confirm-order/query-line-count/\" + confirmOrderId.value).then((response) => {\r\n          let data = response.data;\r\n          if (data.success) {\r\n            let result = data.content;\r\n            switch (result) {\r\n              case -1 :\r\n                notification.success({description: \"购票成功！\"});\r\n                lineModalVisible.value = false;\r\n                clearInterval(queryLineCountInterval);\r\n                break;\r\n              case -2:\r\n                notification.error({description: \"购票失败！\"});\r\n                lineModalVisible.value = false;\r\n                clearInterval(queryLineCountInterval);\r\n                break;\r\n              case -3:\r\n                notification.error({description: \"抱歉，没票了！\"});\r\n                lineModalVisible.value = false;\r\n                clearInterval(queryLineCountInterval);\r\n                break;\r\n              default:\r\n                confirmOrderLineCount.value = result;\r\n            }\r\n          } else {\r\n            notification.error({description: data.message});\r\n          }\r\n        });\r\n      }, 500);\r\n    };\r\n\r\n    /* ------------------- 第二层验证码 --------------------- */\r\n    const imageCodeModalVisible = ref();\r\n    const imageCodeToken = ref();\r\n    const imageCodeSrc = ref();\r\n    const imageCode = ref();\r\n    /**\r\n     * 加载图形验证码\r\n     */\r\n    const loadImageCode = () => {\r\n      imageCodeToken.value = Tool.uuid(8);\r\n      imageCodeSrc.value = process.env.VUE_APP_SERVER + '/business/kaptcha/image-code/' + imageCodeToken.value;\r\n    };\r\n\r\n    const showImageCodeModal = () => {\r\n      loadImageCode();\r\n      imageCodeModalVisible.value = true;\r\n    };\r\n\r\n    /* ------------------- 第一层验证码 --------------------- */\r\n    const firstImageCodeSourceA = ref();\r\n    const firstImageCodeSourceB = ref();\r\n    const firstImageCodeTarget = ref();\r\n    const firstImageCodeModalVisible = ref();\r\n\r\n    /**\r\n     * 加载第一层验证码\r\n     */\r\n    const loadFirstImageCode = () => {\r\n      // 获取1~10的数：Math.floor(Math.random()*10 + 1)\r\n      firstImageCodeSourceA.value = Math.floor(Math.random()*10 + 1) + 10;\r\n      firstImageCodeSourceB.value = Math.floor(Math.random()*10 + 1) + 20;\r\n    };\r\n\r\n    /**\r\n     * 显示第一层验证码弹出框\r\n     */\r\n    const showFirstImageCodeModal = () => {\r\n      loadFirstImageCode();\r\n      firstImageCodeModalVisible.value = true;\r\n    };\r\n\r\n    /**\r\n     * 校验第一层验证码\r\n     */\r\n    const validFirstImageCode = () => {\r\n      if (parseInt(firstImageCodeTarget.value) === parseInt(firstImageCodeSourceA.value + firstImageCodeSourceB.value)) {\r\n        // 第一层验证通过\r\n        firstImageCodeModalVisible.value = false;\r\n        showImageCodeModal();\r\n      } else {\r\n        notification.error({description: '验证码错误'});\r\n      }\r\n    };\r\n\r\n    onMounted(() => {\r\n      handleQueryPassenger();\r\n    });\r\n\r\n    return {\r\n      passengers,\r\n      dailyTrainTicket,\r\n      seatTypes,\r\n      passengerOptions,\r\n      passengerChecks,\r\n      tickets,\r\n      PASSENGER_TYPE_ARRAY,\r\n      visible,\r\n      finishCheckPassenger,\r\n      chooseSeatType,\r\n      chooseSeatObj,\r\n      SEAT_COL_ARRAY,\r\n      handleOk,\r\n      imageCodeToken,\r\n      imageCodeSrc,\r\n      imageCode,\r\n      showImageCodeModal,\r\n      imageCodeModalVisible,\r\n      loadImageCode,\r\n      firstImageCodeSourceA,\r\n      firstImageCodeSourceB,\r\n      firstImageCodeTarget,\r\n      firstImageCodeModalVisible,\r\n      showFirstImageCodeModal,\r\n      validFirstImageCode,\r\n      lineModalVisible,\r\n      confirmOrderId,\r\n      confirmOrderLineCount\r\n    };\r\n  },\r\n});\r\n</script>\r\n\r\n<style>\r\n.order-train .order-train-main {\r\n  font-size: 18px;\r\n  font-weight: bold;\r\n}\r\n.order-train .order-train-ticket {\r\n  margin-top: 15px;\r\n}\r\n.order-train .order-train-ticket .order-train-ticket-main {\r\n  color: red;\r\n  font-size: 18px;\r\n}\r\n\r\n.order-tickets {\r\n  margin: 10px 0;\r\n}\r\n.order-tickets .ant-col {\r\n  padding: 5px 10px;\r\n}\r\n.order-tickets .order-tickets-header {\r\n  background-color: cornflowerblue;\r\n  border: solid 1px cornflowerblue;\r\n  color: white;\r\n  font-size: 16px;\r\n  padding: 5px 0;\r\n}\r\n.order-tickets .order-tickets-row {\r\n  border: solid 1px cornflowerblue;\r\n  border-top: none;\r\n  vertical-align: middle;\r\n  line-height: 30px;\r\n}\r\n\r\n.order-tickets .choose-seat-item {\r\n  margin: 5px 5px;\r\n}\r\n</style>\r\n","import { render } from \"./order.vue?vue&type=template&id=31155547\"\nimport script from \"./order.vue?vue&type=script&lang=js\"\nexport * from \"./order.vue?vue&type=script&lang=js\"\n\nimport \"./order.vue?vue&type=style&index=0&id=31155547&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["class","_createElementVNode","key","style","_createTextVNode","_createElementBlock","_Fragment","_hoisted_1","_hoisted_2","_toDisplayString","_ctx","dailyTrainTicket","date","_hoisted_3","trainCode","_hoisted_4","start","_hoisted_5","startTime","_hoisted_6","_hoisted_7","end","_hoisted_8","endTime","_hoisted_9","_renderList","seatTypes","item","type","desc","_hoisted_10","price","_hoisted_11","count","_createVNode","_component_a_divider","_hoisted_12","_component_a_checkbox_group","value","passengerChecks","_cache","$event","options","passengerOptions","_hoisted_13","tickets","length","_createBlock","_component_a_row","default","_withCtx","_component_a_col","span","_","_createCommentVNode","ticket","passengerId","passengerName","passengerIdCard","_component_a_select","passengerType","PASSENGER_TYPE_ARRAY","_component_a_select_option","code","seatTypeCode","_hoisted_14","_component_a_button","size","onClick","finishCheckPassenger","_component_a_modal","visible","title","onOk","showFirstImageCodeModal","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","chooseSeatType","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","SEAT_COL_ARRAY","_component_a_switch","checked","chooseSeatObj","_hoisted_23","_hoisted_24","imageCodeModalVisible","footer","closable","_hoisted_25","_component_a_input","imageCode","placeholder","suffix","src","imageCodeSrc","alt","loadImageCode","_hoisted_26","block","handleOk","firstImageCodeModalVisible","_hoisted_27","firstImageCodeTarget","firstImageCodeSourceA","firstImageCodeSourceB","validFirstImageCode","lineModalVisible","maskClosable","_hoisted_28","_component_loading_outlined","confirmOrderLineCount","defineComponent","name","setup","passengers","ref","SessionStorage","get","SESSION_ORDER","console","log","SEAT_TYPE","window","KEY","toLowerCase","push","confirmOrderId","watch","newVal","oldVal","forEach","id","idCard","immediate","computed","filter","i","handleQueryPassenger","axios","then","response","data","success","content","label","notification","error","description","message","seatTypesTemp","Tool","copy","j","seatType","ticketSeatTypeCodes","ticketSeatTypeCodesSet","Array","from","Set","YDZ","EDZ","isEmpty","seat","post","dailyTrainTicketId","imageCodeToken","queryLineCount","queryLineCountInterval","setInterval","result","clearInterval","uuid","process","showImageCodeModal","loadFirstImageCode","Math","floor","random","parseInt","onMounted","__exports__","render"],"sourceRoot":""}