"use strict";(self["webpackChunkweb"]=self["webpackChunkweb"]||[]).push([[421],{7421:function(e,a,t){t.r(a),t.d(a,{default:function(){return V}});var l=t(6768),n=t(4232);const i=(0,l.Lk)("br",null,null,-1),d=(0,l.Lk)("br",null,null,-1),o=(0,l.Lk)("br",null,null,-1),r={key:0},u={key:1},s={key:0},v=(0,l.Lk)("br",null,null,-1),c={key:1},m={key:0},p=(0,l.Lk)("br",null,null,-1),y={key:1},k={key:0},g=(0,l.Lk)("br",null,null,-1),C={key:1},w={key:0},h=(0,l.Lk)("br",null,null,-1),E={key:1};function T(e,a,t,T,b,z){const S=(0,l.g2)("a-date-picker"),_=(0,l.g2)("station-select-view"),I=(0,l.g2)("a-button"),x=(0,l.g2)("a-space"),X=(0,l.g2)("a-table");return(0,l.uX)(),(0,l.CE)(l.FK,null,[(0,l.Lk)("p",null,[(0,l.bF)(x,null,{default:(0,l.k6)((()=>[(0,l.bF)(S,{value:e.params.date,"onUpdate:value":a[0]||(a[0]=a=>e.params.date=a),valueFormat:"YYYY-MM-DD",placeholder:"请选择日期"},null,8,["value"]),(0,l.bF)(_,{modelValue:e.params.start,"onUpdate:modelValue":a[1]||(a[1]=a=>e.params.start=a),width:"200px"},null,8,["modelValue"]),(0,l.bF)(_,{modelValue:e.params.end,"onUpdate:modelValue":a[2]||(a[2]=a=>e.params.end=a),width:"200px"},null,8,["modelValue"]),(0,l.bF)(I,{type:"primary",onClick:a[3]||(a[3]=a=>e.handleQuery())},{default:(0,l.k6)((()=>[(0,l.eW)("查找")])),_:1})])),_:1})]),(0,l.bF)(X,{dataSource:e.dailyTrainTickets,columns:e.columns,pagination:e.pagination,onChange:e.handleTableChange,loading:e.loading},{bodyCell:(0,l.k6)((({column:a,record:t})=>["operation"===a.dataIndex?((0,l.uX)(),(0,l.Wv)(I,{key:0,type:"primary",onClick:a=>e.toOrder(t)},{default:(0,l.k6)((()=>[(0,l.eW)("预订")])),_:2},1032,["onClick"])):"station"===a.dataIndex?((0,l.uX)(),(0,l.CE)(l.FK,{key:1},[(0,l.eW)((0,n.v_)(t.start),1),i,(0,l.eW)(" "+(0,n.v_)(t.end),1)],64)):"time"===a.dataIndex?((0,l.uX)(),(0,l.CE)(l.FK,{key:2},[(0,l.eW)((0,n.v_)(t.startTime),1),d,(0,l.eW)(" "+(0,n.v_)(t.endTime),1)],64)):"duration"===a.dataIndex?((0,l.uX)(),(0,l.CE)(l.FK,{key:3},[(0,l.eW)((0,n.v_)(e.calDuration(t.startTime,t.endTime)),1),o,t.startTime.replaceAll(":","")>=t.endTime.replaceAll(":","")?((0,l.uX)(),(0,l.CE)("div",r," 次日到达 ")):((0,l.uX)(),(0,l.CE)("div",u," 当日到达 "))],64)):"ydz"===a.dataIndex?((0,l.uX)(),(0,l.CE)(l.FK,{key:4},[t.ydz>=0?((0,l.uX)(),(0,l.CE)("div",s,[(0,l.eW)((0,n.v_)(t.ydz),1),v,(0,l.eW)(" "+(0,n.v_)(t.ydzPrice)+"￥ ",1)])):((0,l.uX)(),(0,l.CE)("div",c," -- "))],64)):"edz"===a.dataIndex?((0,l.uX)(),(0,l.CE)(l.FK,{key:5},[t.edz>=0?((0,l.uX)(),(0,l.CE)("div",m,[(0,l.eW)((0,n.v_)(t.edz),1),p,(0,l.eW)(" "+(0,n.v_)(t.edzPrice)+"￥ ",1)])):((0,l.uX)(),(0,l.CE)("div",y," -- "))],64)):"rw"===a.dataIndex?((0,l.uX)(),(0,l.CE)(l.FK,{key:6},[t.rw>=0?((0,l.uX)(),(0,l.CE)("div",k,[(0,l.eW)((0,n.v_)(t.rw),1),g,(0,l.eW)(" "+(0,n.v_)(t.rwPrice)+"￥ ",1)])):((0,l.uX)(),(0,l.CE)("div",C," -- "))],64)):"yw"===a.dataIndex?((0,l.uX)(),(0,l.CE)(l.FK,{key:7},[t.yw>=0?((0,l.uX)(),(0,l.CE)("div",w,[(0,l.eW)((0,n.v_)(t.yw),1),h,(0,l.eW)(" "+(0,n.v_)(t.ywPrice)+"￥ ",1)])):((0,l.uX)(),(0,l.CE)("div",E," -- "))],64)):(0,l.Q3)("",!0)])),_:1},8,["dataSource","columns","pagination","onChange","loading"])],64)}t(4114);var b=t(144),z=t(5108),S=t(8355);function _(e,a,t,i,d,o){const r=(0,l.g2)("a-select-option"),u=(0,l.g2)("a-select");return(0,l.uX)(),(0,l.Wv)(u,{value:e.name,"onUpdate:value":a[0]||(a[0]=a=>e.name=a),"show-search":"",allowClear:"",filterOption:e.filterNameOption,onChange:e.onChange,placeholder:"请选择车站",style:(0,n.Tr)("width: "+e.localWidth)},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(e.stations,(e=>((0,l.uX)(),(0,l.Wv)(r,{key:e.name,value:e.name,label:e.name+e.namePinyin+e.namePy},{default:(0,l.k6)((()=>[(0,l.eW)((0,n.v_)(e.name)+" "+(0,n.v_)(e.namePinyin)+" ~ "+(0,n.v_)(e.namePy),1)])),_:2},1032,["value","label"])))),128))])),_:1},8,["value","filterOption","onChange","style"])}var I=(0,l.pM)({name:"station-select-view",props:["modelValue","width"],emits:["update:modelValue","change"],setup(e,{emit:a}){const t=(0,b.KR)(),n=(0,b.KR)([]),i=(0,b.KR)(e.width);Tool.isEmpty(e.width)&&(i.value="100%"),(0,l.wB)((()=>e.modelValue),(()=>{console.log("props.modelValue",e.modelValue),t.value=e.modelValue}),{immediate:!0});const d=()=>{S.A.get("/business/station/query-all").then((e=>{let a=e.data;a.success?n.value=a.content:z.A.error({description:a.message})}))},o=(e,a)=>(console.log(e,a),a.label.toLowerCase().indexOf(e.toLowerCase())>=0),r=e=>{a("update:modelValue",e);let t=n.value.filter((a=>a.code===e))[0];Tool.isEmpty(t)&&(t={}),a("change",t)};return(0,l.sV)((()=>{d()})),{name:t,stations:n,filterNameOption:o,onChange:r,localWidth:i}}}),x=t(1241);const X=(0,x.A)(I,[["render",_]]);var f=X,W=t(1576),K=t.n(W),A=t(9325),F=(0,l.pM)({name:"ticket-view",components:{StationSelectView:f},setup(){const e=(0,b.KR)(!1);let a=(0,b.KR)({id:void 0,date:void 0,trainCode:void 0,start:void 0,startPinyin:void 0,startTime:void 0,startIndex:void 0,end:void 0,endPinyin:void 0,endTime:void 0,endIndex:void 0,ydz:void 0,ydzPrice:void 0,edz:void 0,edzPrice:void 0,rw:void 0,rwPrice:void 0,yw:void 0,ywPrice:void 0,createTime:void 0,updateTime:void 0});const t=(0,b.KR)([]),n=(0,b.KR)({total:0,current:1,pageSize:10});let i=(0,b.KR)(!1);const d=(0,b.KR)({}),o=[{title:"车次编号",dataIndex:"trainCode",key:"trainCode"},{title:"车站",dataIndex:"station"},{title:"时间",dataIndex:"time"},{title:"历时",dataIndex:"duration"},{title:"一等座",dataIndex:"ydz",key:"ydz"},{title:"二等座",dataIndex:"edz",key:"edz"},{title:"软卧",dataIndex:"rw",key:"rw"},{title:"硬卧",dataIndex:"yw",key:"yw"},{title:"操作",dataIndex:"operation"}],r=e=>{Tool.isEmpty(d.value.date)?z.A.error({description:"请输入日期"}):Tool.isEmpty(d.value.start)?z.A.error({description:"请输入出发地"}):Tool.isEmpty(d.value.end)?z.A.error({description:"请输入目的地"}):(e||(e={page:1,size:n.value.pageSize}),SessionStorage.set(SESSION_TICKET_PARAMS,d.value),i.value=!0,S.A.get("/business/daily-train-ticket/query-list",{params:{page:e.page,size:e.size,trainCode:d.value.trainCode,date:d.value.date,start:d.value.start,end:d.value.end}}).then((a=>{i.value=!1;let l=a.data;l.success?(t.value=l.content.list,n.value.current=e.page,n.value.total=l.content.total):z.A.error({description:l.message})})))},u=e=>{n.value.pageSize=e.pageSize,r({page:e.current,size:e.pageSize})},s=(e,a)=>{let t=K()(a,"HH:mm:ss").diff(K()(e,"HH:mm:ss"),"seconds");return K()("00:00:00","HH:mm:ss").second(t).format("HH:mm:ss")},v=e=>{a.value=Tool.copy(e),SessionStorage.set(SESSION_ORDER,a.value),A.A.push("/order")};return(0,l.sV)((()=>{d.value=SessionStorage.get(SESSION_TICKET_PARAMS)||{},Tool.isNotEmpty(d.value)&&r({page:1,size:n.value.pageSize})})),{dailyTrainTicket:a,visible:e,dailyTrainTickets:t,pagination:n,columns:o,handleTableChange:u,handleQuery:r,loading:i,params:d,calDuration:s,toOrder:v}}});const P=(0,x.A)(F,[["render",T]]);var V=P}}]);
//# sourceMappingURL=421.a93e8a10.js.map